<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="css/my.css">
  <link rel="stylesheet" href="lib/book/book.css">
  <style>
    .book__img {
      width: 100%;
      height: 100%;
    }
    .book {
      --border: 1px solid #ddd;
      --border-radius: 6%;
    }
    .book__page {
      line-height: 0;
    }

    .content {
      position: relative;
    }
    .content__book {
      width: 100%;
    }
    .content__hint {
      position: absolute;
      top: 0;
      left: 0;
      width: 50%;
    }
    .content__hint-video {
      width: 100%;
      background-color: white;
    }
  </style>
  <script type="text/javascript" src="lib/book/Book.js"></script>
  <script defer>
    window.onload = () => {
      const bookDomElement = document.getElementById('book');
      bookDomElement.addEventListener('pageVisibilityChange', onPageVisibilityChange);
      new Book(bookDomElement);
    };

    const onceOpenedPages = [];

    function onPageVisibilityChange({ detail: { pageDomElement, index, visible } }) {
      if (!visible || onceOpenedPages[index]) {
        return;
      }

      onceOpenedPages[index] = true;

      const videos = pageDomElement.getElementsByTagName('video');
      if (videos.length) {
        videos[0].removeAttribute('preload')
        videos[0].setAttribute('autoplay', 'autoplay');
        videos[0].load();
      }

      const images = pageDomElement.getElementsByTagName('img');
      if (images.length) {
        images[0].setAttribute('src', images[0].dataset.src);
      }
    }
  </script>
</head>
<body class="body">
  <div class="content">
    <div class="content__hint">
      <video class="content__hint-video" autoplay="autoplay" loop="loop" muted="muted" playsinline="playsinline">
        <source src="pages/hint.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>
      </video>
    </div>
    <div class="book content__book" id="book">
      <div class="book__page">
        <video class="book__img" loop="loop" muted="muted" playsinline="playsinline" preload="none">
          <source src="pages/1.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>
        </video>
      </div>
      <div class="book__page">
        <img class="book__img" src="" data-src="pages/2.jpg" />
      </div>
      <div class="book__page">
        <img class="book__img" src="" data-src="pages/3.jpg" />
      </div>
      <div class="book__page">
        <video class="book__img" loop="loop" muted="muted" playsinline="playsinline" preload="none">
          <source src="pages/4.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>
        </video>
      </div>
      <div class="book__page">
        <video class="book__img" loop="loop" muted="muted" playsinline="playsinline" preload="none">
          <source src="pages/5.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>
        </video>
      </div>
      <div class="book__page">
        <video class="book__img" loop="loop" muted="muted" playsinline="playsinline" preload="none">
          <source src="pages/6.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>
        </video>
      </div>
      <div class="book__page">
        <img class="book__img" src="" data-src="pages/7.jpg" />
      </div>
      <div class="book__page">
        <img class="book__img" src="" data-src="pages/8.jpg" />
      </div>
      <div class="book__page">
        <video class="book__img" loop="loop" muted="muted" playsinline="playsinline" preload="none">
          <source src="pages/9.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>
        </video>
      </div>
      <div class="book__page">
        <video class="book__img" loop="loop" muted="muted" playsinline="playsinline" preload="none">
          <source src="pages/10.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>
        </video>
      </div>
      <div class="book__page">
        <video class="book__img" loop="loop" muted="muted" playsinline="playsinline" preload="none">
          <source src="pages/11.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>
        </video>
      </div>
      <div class="book__page">
        <video class="book__img" loop="loop" muted="muted" playsinline="playsinline" preload="none" data-leadof="fish-r">
          <source src="pages/IMG-0402.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>
        </video>
      </div>
      <div class="book__page">
        <video class="book__img" loop="loop" muted="muted" playsinline="playsinline" preload="none" data-dependant="true" id="fish-r">
          <source src="pages/IMG-0401.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>
        </video>
      </div>
      <div class="book__page">
        <video class="book__img" loop="loop" muted="muted" playsinline="playsinline" preload="none" data-leadof="cat-r">
          <source src="pages/IMG-0647.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>
        </video>
      </div>
      <div class="book__page">
        <video class="book__img" loop="loop" muted="muted" playsinline="playsinline" preload="none" data-dependant="true" id="cat-r">
          <source src="pages/IMG-0648.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>
        </video>
      </div>
      <div class="book__page">
        <img class="book__img" src="" data-src="pages/12.jpg" />
      </div>
      <div class="book__page">
        <img class="book__img" src="" data-src="pages/13.jpg" />
      </div>
    </div>
    <div class="links content__links">
      <a
        href="https://www.instagram.com/maristorii/"
        target="_blank"
        class="links__item links__item_type_insta-only"
        title="Instagram: maristorii"
      ></a>
    </div>
  </div>


  <!-- Yandex.Metrika counter -->
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(55540834, "init", {
      clickmap:true,
      trackLinks:true,
      accurateTrackBounce:true
    });
  </script>
  <noscript>
    <div><img src="https://mc.yandex.ru/watch/55540834" style="position:absolute; left:-9999px;" alt="" /></div>
  </noscript>
  <!-- /Yandex.Metrika counter -->
</body>
</html>
